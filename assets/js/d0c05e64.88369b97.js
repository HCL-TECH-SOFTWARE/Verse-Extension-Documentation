"use strict";(self.webpackChunkverse_developer=self.webpackChunkverse_developer||[]).push([[121],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return u}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),m=l(n),u=o,f=m["".concat(p,".").concat(u)]||m[u]||c[u]||a;return n?r.createElement(f,i(i({ref:t},d),{},{components:n})):r.createElement(f,i({ref:t},d))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8873:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(7294),o=n(4996),a=function(e){var t=e.path,n=r.useState(!1),a=n[0],i=n[1],s=r.useState({}),p=s[0],l=s[1],d=r.useRef(null),c=function(e){e.preventDefault(),i(!a)},m=function(e){a&&(e.preventDefault(),i(!1))};return r.useEffect((function(){return document.body.addEventListener("keydown",m),function(){document.body.removeEventListener("keydown",m)}}),[]),r.useEffect((function(){var e=document.getElementsByClassName("navbar")[0];a&&d.current?(document.body.setAttribute("style","overflow:hidden;"),l({top:e.offsetTop})):(document.body.removeAttribute("style"),d.current.focus(),l({}))}),[a]),r.createElement("div",{onKeyPress:c,onClick:c,className:a?"expandable-container expanded":"expandable-container",ref:d,style:p},r.createElement("img",{tabIndex:"0",className:a?"image image-expanded":"image",src:(0,o.Z)(t)}))}},4658:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return f},frontMatter:function(){return p},metadata:function(){return d},toc:function(){return m}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=n(8873),s=["components"],p={id:"hook-before-send",title:"Hook Before Send"},l=void 0,d={unversionedId:"hook-before-send",id:"hook-before-send",title:"Hook Before Send",description:"",source:"@site/docs/before-on-send.md",sourceDirName:".",slug:"/hook-before-send",permalink:"/Verse-Extension-Documentation/docs/hook-before-send",tags:[],version:"current",frontMatter:{id:"hook-before-send",title:"Hook Before Send"},sidebar:"tutorials_examples",previous:{title:"Custom Name Picker",permalink:"/Verse-Extension-Documentation/docs/custom-name-picker"},next:{title:"Modify On Send",permalink:"/Verse-Extension-Documentation/docs/modify-on-send"}},c={},m=[{value:"Add the Extension",id:"add-the-extension",level:2},{value:"Extension Properties",id:"extension-properties",level:4},{value:"Test it Out",id:"test-it-out",level:2},{value:"How it Works",id:"how-it-works",level:2}],u={toc:m};function f(e){var t=e.components,n=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This sample application adds one extension to the ",(0,a.kt)("inlineCode",{parentName:"p"},"applications.json")," extension array, a ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../extension-points#beforeonsend"},"BeforeOnSend"))," extension. You can use this extension to perform logic on an email and prevent it from being sent."),(0,a.kt)("h2",{id:"add-the-extension"},"Add the Extension"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'[\n  {\n    "name": "Hook Before Send",\n    "title": "Hook Before Send Sample",\n    "description": "Sample that shows how to check for a credit card number before sending",\n    "extensions": [\n      {\n        "type": "com.ibm.verse.ext.beforeOnSend",\n        "name": "Hook Before Send Extension",\n        "title": "Credit Card Checker",\n        "payload": {\n          "url": "${extensionPath}/hook-before-send/index.html"\n        }\n      }\n    ],\n    "services": [\n      "Verse"\n    ]\n  }\n]\n')),(0,a.kt)("h4",{id:"extension-properties"},"Extension Properties"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Property"),(0,a.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Definition"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"name"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"the name of the application")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"type"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"the extension point  (",(0,a.kt)("a",{parentName:"td",href:"../extension-points"},"List of Extension Points"),")")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"title"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"title of your extension")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"url"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"The fully-qualified URL of your application")))),(0,a.kt)("h2",{id:"test-it-out"},"Test it Out"),(0,a.kt)(i.A,{path:"samples/before-on-send.gif",mdxType:"Expandable"}),(0,a.kt)("h2",{id:"how-it-works"},"How it Works"),(0,a.kt)("p",null,"This ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../extension-points#beforeonsend"},"BeforeOnSend"))," extension example adds some verification logic to the send email action in HCL Verse. As you can see in the demo above, sending an email that contains a credit card number is prevented and requires user confirmation to continue. "),(0,a.kt)("p",null,"The extension also leverages the ",(0,a.kt)("inlineCode",{parentName:"p"},"VerseDataAPI")," thus, the sample web application has access to the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../extension-data-api#mail-compose"},"Mail Compose"))," data context: ",(0,a.kt)("inlineCode",{parentName:"p"},"recipients"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"subject"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"body"),", etc. The script, ",(0,a.kt)("inlineCode",{parentName:"p"},"hook-before-send/script.js"),", handles the cross-document messaging ",(0,a.kt)("em",{parentName:"p"},"handshake")," to let Verse know it is ready to receive data. When the sample web application receives a message event with the ",(0,a.kt)("inlineCode",{parentName:"p"},"verseApiType")," of ",(0,a.kt)("inlineCode",{parentName:"p"},"com.ibm.verse.action.clicked")," the data context is there as well. As always, it is good practice to confirm the ",(0,a.kt)("inlineCode",{parentName:"p"},"actionId")," to ensure the data you recieve is coming from the correct action; the ",(0,a.kt)("inlineCode",{parentName:"p"},"actionId")," is ",(0,a.kt)("inlineCode",{parentName:"p"},"com.ibm.verse.ext.action.beforeOnSend"),"."),(0,a.kt)("p",null,"For this tutorial, the ",(0,a.kt)("inlineCode",{parentName:"p"},"body")," attribute of the ",(0,a.kt)("inlineCode",{parentName:"p"},"verseDataAPI")," is used to search for a ",(0,a.kt)("em",{parentName:"p"},"credit card-like")," string inside the body of the email. If no matches are found, a message is sent back to Verse with the ",(0,a.kt)("inlineCode",{parentName:"p"},"verseApiType"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"com.ibm.verse.message.continue.send"),". Otherwise, the ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," page is displayed as an embedded frame within the ",(0,a.kt)("inlineCode",{parentName:"p"},"Mail Compose")," view with an appropriate warning message. The user has the option to revise the email or can bypass the warning and send the email anyways. "),(0,a.kt)("p",null,"There is the option to disable sending completely by setting ",(0,a.kt)("inlineCode",{parentName:"p"},"disableSend: true")," in the ",(0,a.kt)("inlineCode",{parentName:"p"},"payload"),". Please reference the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../extension-points#beforeonsend"},"BeforeOnSend"))," extension documentation for more information."))}f.isMDXComponent=!0}}]);