(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{85:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return l}));var a=n(2),i=n(6),r=(n(0),n(88)),o=n(92),s={id:"modify-on-send",title:"Modify On Send"},c={unversionedId:"modify-on-send",id:"modify-on-send",isDocsHomePage:!1,title:"Modify On Send",description:"With an User Interface",source:"@site/docs\\modify-on-send.md",permalink:"/Verse-Extension-Documentation/docs/modify-on-send",sidebar:"tutorials_examples",previous:{title:"Hook Before Send",permalink:"/Verse-Extension-Documentation/docs/hook-before-send"},next:{title:"Live Text Widget",permalink:"/Verse-Extension-Documentation/docs/live-text-widget"}},b=[{value:"With an User Interface",id:"with-an-user-interface",children:[{value:"Add the Extension",id:"add-the-extension",children:[]},{value:"Test it out",id:"test-it-out",children:[]},{value:"How it Works",id:"how-it-works",children:[]}]},{value:"Without an User Interface",id:"without-an-user-interface",children:[{value:"Add the Extension",id:"add-the-extension-1",children:[]},{value:"Test it out",id:"test-it-out-1",children:[]},{value:"How it Works",id:"how-it-works-1",children:[]}]}],d={rightToc:b};function l(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"with-an-user-interface"},"With an User Interface"),Object(r.b)("p",null,"This sample application adds one extension to the ",Object(r.b)("inlineCode",{parentName:"p"},"applications.json")," extension array, a ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-points#modify-on-send"}),"Modify On Send"))," extension. You can use this extension to present the user with a UI as well as (optionally) modify the message before it is sent."),Object(r.b)("p",null,"View this extension's source ","*","*",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/HCL-TECH-SOFTWARE/Verse-Extension-samples/tree/master/src/modify-on-send/with-ui"}),"here"),"."),Object(r.b)("h3",{id:"add-the-extension"},"Add the Extension"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'[\n  {\n    name: "ModifyOnSend",\n    title: "ModifyOnSend",\n    description:\n      "This sample demonstrates using the ModifyOnSend extension point",\n    extensions: [\n      {\n        name: "Modify on Send",\n        type: "com.ibm.verse.ext.modifyOnSend",\n        title: "Modify the contents of mail",\n        payload: {\n          location: "embedded",\n          pattern: "\\\\[(PROTECTED|PRIVATE|CLASSIFIED|SECRET)\\\\](\\\\s*)",\n          url: "${extensionPath}/modify-on-send/with-ui/index.html",\n        },\n      },\n    ],\n    services: ["Verse"],\n  },\n];\n')),Object(r.b)("h4",{id:"extension-properties"},"Extension Properties"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Property"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Type"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Definition"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"name"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The name of the extension")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"type"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The extension point (",Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"./extension-points"}),"List of Extension Points"),")")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"title"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The title of the extension")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"location"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"embedded - Indicates that the extension will render a UI")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"pattern"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"A regex to limit what subject modifications the extension can make")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"url"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The fully-qualified URL of your application")))),Object(r.b)("h3",{id:"test-it-out"},"Test it out"),Object(r.b)(o.a,{path:"samples/modify-on-send-with-ui.gif",mdxType:"Expandable"}),Object(r.b)("h3",{id:"how-it-works"},"How it Works"),Object(r.b)("p",null,"This ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-points#modify-on-send"}),"Modify On Send"))," extension example prompts the user to add a classificiation to the subject of each email being sent. Additionally, this extension appends a signature to the end of the message body. This can be useful to inject a disclaimer at the end of each message being sent."),Object(r.b)("p",null,"The extension leverages the ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-data-api#mail-compose"}),"Mail Compose data api")),", Thus, the sample web application has access to the mail's data context. The script, ",Object(r.b)("inlineCode",{parentName:"p"},"modify-on-send/with-ui/script.js"),", handles the cross-document messaging ",Object(r.b)("em",{parentName:"p"},"handshake")," to let Verse know that the extension is ready to receive data. When the sample web application receives a message event with the ",Object(r.b)("inlineCode",{parentName:"p"},"verseApiType")," of ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.message.modify.mail")," the data context is there as well. As always, it is good practice to confirm the ",Object(r.b)("inlineCode",{parentName:"p"},"actionId")," to ensure the data you recieve is coming from the correct action; the ",Object(r.b)("inlineCode",{parentName:"p"},"actionId")," is ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.ext.action.modifyOnSend"),"."),Object(r.b)("p",null,"For this tutorial, the user is presented with a simple UI that allows the user to pick from a list of classifications, or the user can choose to skip classifying the message. Once the user picks a selection, the selected classification is appended to the beginning of the original subject."),Object(r.b)("p",null,"This extension specified a ",Object(r.b)("inlineCode",{parentName:"p"},"pattern")," which will restrict the modifications that can be made to the subject. There is one classification option that is not part of the acceptable pattern. If the user makes this selection, the message's subject will not be updated and the message will not be sent. If the user picks a valid classification, then the pattern check will indicate to Verse that the subject should be modified before the message is sent."),Object(r.b)("p",null,"This extension also appends a simple sentence to the end of the mail message's body. This could be leveraged to automatically append a disclaimer statement at the end of all outgoing messages."),Object(r.b)("p",null,"If the user selects to send the message without modifications, the message will be sent without any modifications having been made."),Object(r.b)("p",null,"Since this is an embedded extension, the extension will not be automatically terminated after a period of time. This allows the end user ample time to interact with the UI being presented."),Object(r.b)("h2",{id:"without-an-user-interface"},"Without an User Interface"),Object(r.b)("p",null,"This sample application adds one extension to the ",Object(r.b)("inlineCode",{parentName:"p"},"applications.json")," extension array, a ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-points#modify-on-send"}),"Modify On Send"))," extension. You can use this extension to modify a message before it is sent, without presenting a UI to the end user.."),Object(r.b)("p",null,"View this extension's source ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"https://github.com/HCL-TECH-SOFTWARE/Verse-Extension-samples/tree/master/src/modify-on-send/no-ui"}),"here")),"."),Object(r.b)("h3",{id:"add-the-extension-1"},"Add the Extension"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'[\n  {\n    name: "ModifyOnSend",\n    title: "ModifyOnSend",\n    description:\n      "This sample demonstrates using the ModifyOnSend extension point",\n    extensions: [\n      {\n        name: "Modify on Send",\n        type: "com.ibm.verse.ext.modifyOnSend",\n        title: "Modify the contents of mail",\n        payload: {\n          url: "${extensionPath}/modify-on-send/no-ui/index.html",\n        },\n      },\n    ],\n    services: ["Verse"],\n  },\n];\n')),Object(r.b)("h4",{id:"extension-properties-1"},"Extension Properties"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Property"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Type"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Definition"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"name"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The name of the extension")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"type"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The extension point (",Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"./extension-points"}),"List of Extension Points"),")")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"title"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The title of the extension")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"url"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),Object(r.b)("inlineCode",{parentName:"td"},"string")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"The fully-qualified URL of your application")))),Object(r.b)("h3",{id:"test-it-out-1"},"Test it out"),Object(r.b)(o.a,{path:"samples/modify-on-send-no-ui.gif",mdxType:"Expandable"}),Object(r.b)("h3",{id:"how-it-works-1"},"How it Works"),Object(r.b)("p",null,"This ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-points#modify-on-send"}),"Modify On Send"))," extension example modifies the subject of each email being sent without presenting any UI to the end user. Additionally, this extension appends a signature to the end of the message body. This can be useful to inject a disclaimer at the end of each message being sent."),Object(r.b)("p",null,"The extension leverages the ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"./extension-data-api#mail-compose"}),"Mail Compose data api")),". Thus, the sample web application has access to the mail's data context. The script, ",Object(r.b)("inlineCode",{parentName:"p"},"modify-on-send/with-ui/script.js"),", handles the cross-document messaging ",Object(r.b)("em",{parentName:"p"},"handshake")," to let Verse know that the extension is ready to receive data. When the sample web application receives a message event with the ",Object(r.b)("inlineCode",{parentName:"p"},"verseApiType")," of ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.message.modify.mail")," the data context is there as well. As always, it is good practice to confirm the ",Object(r.b)("inlineCode",{parentName:"p"},"actionId")," to ensure the data you recieve is coming from the correct action; the ",Object(r.b)("inlineCode",{parentName:"p"},"actionId")," is ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.ext.action.modifyOnSend"),"."),Object(r.b)("p",null,"For this tutorial, the extension will ignore messages being sent with the string ",Object(r.b)("inlineCode",{parentName:"p"},'"MODIFYONSEND"')," in the subject. If the subject does not contain ",Object(r.b)("inlineCode",{parentName:"p"},'"MODIFYONSEND"'),", then the extension will modify the subject of the message to prepend ",Object(r.b)("inlineCode",{parentName:"p"},'"[MODIFIED SUBJECT] "')," to the original subject."),Object(r.b)("p",null,"This extension does not specify a ",Object(r.b)("inlineCode",{parentName:"p"},"pattern"),". Therefore, the only restriction for the modified subject is that the modified subject must contain the original subject. This is due to the ",Object(r.b)("inlineCode",{parentName:"p"},"modifiedSubjectMustContainOriginalSubject")," property having a default value of ",Object(r.b)("inlineCode",{parentName:"p"},"true"),"."),Object(r.b)("p",null,"This extension also appends a simple sentence to the end of the mail message's body. This could be leveraged to automatically append a disclaimer statement at the end of all outgoing messages."),Object(r.b)("p",null,"Once the extension has responded to Verse with ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.message.modify.mail")," or ",Object(r.b)("inlineCode",{parentName:"p"},"com.ibm.verse.message.continue.send")," verseApiType (depending on whether or not the original subject contained ",Object(r.b)("inlineCode",{parentName:"p"},"MODIFYONSEND"),"), the extension will be terminated by Verse and modifications will be handled appropriately based on the properties of the extension."))}l.isMDXComponent=!0},88:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=i.a.createContext({}),d=function(e){var t=i.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=d(e.components);return i.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},m=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),l=d(n),m=a,h=l["".concat(o,".").concat(m)]||l[m]||p[m]||r;return n?i.a.createElement(h,s(s({ref:t},b),{},{components:n})):i.a.createElement(h,s({ref:t},b))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var b=2;b<r;b++)o[b]=n[b];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},89:function(e,t,n){"use strict";var a=n(0),i=n(20);t.a=function(){var e=Object(a.useContext)(i.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},90:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(89),i=n(91);function r(){var e=Object(a.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,r=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var r=void 0===a?{}:a,o=r.forcePrependBaseUrl,s=void 0!==o&&o,c=r.absolute,b=void 0!==c&&c;if(!n)return n;if(n.startsWith("#"))return n;if(Object(i.b)(n))return n;if(s)return t+n;var d=!n.startsWith(t)?t+n.replace(/^\//,""):n;return b?e+d:d}(r,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,r().withBaseUrl)(e,t)}},91:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},92:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),i=n.n(a),r=(n(47),n(90)),o=function(e){var t=e.path,n=i.a.useState(!1),a=n[0],o=n[1],s=i.a.useState({}),c=s[0],b=s[1],d=i.a.useRef(null),l=function(e){e.preventDefault(),o(!a)},p=function(e){a&&(e.preventDefault(),o(!1))};return i.a.useEffect((function(){return document.body.addEventListener("keydown",p),function(){document.body.removeEventListener("keydown",p)}}),[]),i.a.useEffect((function(){var e=document.getElementsByClassName("navbar")[0];a&&d.current?(document.body.setAttribute("style","overflow:hidden;"),b({top:e.offsetTop})):(document.body.removeAttribute("style"),d.current.focus(),b({}))}),[a]),i.a.createElement("div",{onKeyPress:l,onClick:l,className:a?"expandable-container expanded":"expandable-container",ref:d,style:c},i.a.createElement("img",{tabIndex:"0",className:a?"image image-expanded":"image",src:Object(r.a)(t)}))}}}]);